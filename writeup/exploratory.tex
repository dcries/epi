\documentclass[11pt]{article}

\usepackage{hyperref, lastpage, fancyhdr,multicol,caption,subcaption,tabularx}
\usepackage{amsmath,graphicx}
\usepackage{float}

\usepackage{geometry}
\usepackage{pdflscape}



\topmargin      -1.5cm   % read Lamport p.163
\oddsidemargin  -0.04cm  % read Lamport p.163
\evensidemargin -0.04cm  % same as oddsidemargin but for left-hand pages
\textwidth      16.59cm
\textheight     23.94cm
\parskip         7.2pt   % sets spacing between paragraphs
\parindent         0pt   % sets leading space for paragraphs
\pagestyle{empty}        % Uncomment if don't want page numbers
\pagestyle{fancyplain}

\usepackage{natbib} %need this for bibtex
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}

\lhead{}
\chead{}
\rhead{}

\usepackage{setspace} %for double spacing
\doublespacing


\usepackage{Sweave}
\begin{document}
\input{exploratory-concordance}



\begin{Schunk}
\begin{Sinput}
> sum(nhanes$modvigmin==0)/nrow(nhanes) 
\end{Sinput}
\begin{Soutput}
[1] 0.07841659
\end{Soutput}
\begin{Sinput}
> sum(nhanes$vigmin==0)/nrow(nhanes)
\end{Sinput}
\begin{Soutput}
[1] 0.8801602
\end{Soutput}
\begin{Sinput}
> sum(nhanes$lightmin==0)/nrow(nhanes)
\end{Sinput}
\begin{Soutput}
[1] 0
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> #no diff in modmin by day really except 7th
> nhanes %>% group_by(rep) %>% summarise(m=mean(modvigmin),s=sd(modmin)/sqrt(length(modmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 7 x 3
    rep        m         s
  <int>    <dbl>     <dbl>
1     1 22.60066 0.3411052
2     2 23.01777 0.3518468
3     3 22.96771 0.3583861
4     4 22.41386 0.3488521
5     5 22.24356 0.3589189
6     6 21.15523 0.3571320
7     7 19.41996 0.3616865
\end{Soutput}
\begin{Sinput}
> #no diff in modmin by day really except 7th and 2nd
> nhanes %>% group_by(rep) %>% summarise(m=mean(lightmin),s=sd(lightmin)/sqrt(length(lightmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 7 x 3
    rep        m        s
  <int>    <dbl>    <dbl>
1     1 258.6827 1.048918
2     2 261.5339 1.093391
3     3 258.6147 1.096388
4     4 258.8213 1.136550
5     5 258.2212 1.160056
6     6 255.2295 1.186014
7     7 244.4119 1.253172
\end{Soutput}
\begin{Sinput}
> #mondays most vig, fri-sun least, tues-thurs similar
> nhanes %>% group_by(rep) %>% summarise(m=mean(vigmin),s=sd(vigmin)/sqrt(length(lightmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 7 x 3
    rep         m          s
  <int>     <dbl>      <dbl>
1     1 0.9411853 0.06110670
2     2 0.8115414 0.05276647
3     3 0.8965840 0.06021138
4     4 0.7660865 0.05689883
5     5 0.7392597 0.05397894
6     6 0.8310108 0.06361269
7     7 0.6902050 0.06106663
\end{Soutput}
\begin{Sinput}
> anova(lm(modvigmin~as.factor(rep),data=subset(nhanes,rep<6))) #first 5 days are similar, last two
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Response: modvigmin
                  Df   Sum Sq Mean Sq F value Pr(>F)
as.factor(rep)     4     2902  725.44  0.8288 0.5065
Residuals      31937 27954416  875.30               
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> #weekends lower
> nhanes %>% group_by(dow) %>% summarise(m=mean(modvigmin),s=sd(modvigmin)/sqrt(length(modvigmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 7 x 3
    dow        m         s
  <int>    <dbl>     <dbl>
1     1 17.46672 0.3539009
2     2 23.63394 0.3753241
3     3 23.49455 0.3683897
4     4 23.63173 0.3842220
5     5 23.18340 0.3712310
6     6 22.43408 0.3639320
7     7 19.52794 0.3799264
\end{Soutput}
\begin{Sinput}
> #weekends and thursday lower, friday higher
> nhanes %>% group_by(dow) %>% summarise(m=mean(lightmin),s=sd(lightmin)/sqrt(length(lightmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 7 x 3
    dow        m        s
  <int>    <dbl>    <dbl>
1     1 239.7397 1.171315
2     2 259.8399 1.106457
3     3 260.0095 1.095333
4     4 259.8370 1.102353
5     5 256.6507 1.103868
6     6 263.0100 1.146749
7     7 256.8055 1.218114
\end{Soutput}
\begin{Sinput}
> #first day vig
> nhanes %>% group_by(dow) %>% summarise(m=mean(vigmin),s=sd(vigmin)/sqrt(length(lightmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 7 x 3
    dow         m          s
  <int>     <dbl>      <dbl>
1     1 0.7239862 0.06502960
2     2 0.9462687 0.06184397
3     3 0.8742129 0.05357820
4     4 0.8859250 0.06278267
5     5 0.8446359 0.05683506
6     6 0.7264334 0.05487292
7     7 0.6707994 0.05419137
\end{Soutput}
\begin{Sinput}
> anova(lm(modvigmin~as.factor(dow),data=subset(nhanes,dow%in%c(2:6)))) #M-F similar
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Response: modvigmin
                  Df   Sum Sq Mean Sq F value Pr(>F)
as.factor(dow)     4     6363 1590.75  1.7992 0.1259
Residuals      31803 28118692  884.15               
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> #test for weekend effects
> anova(lm(modvigmin ~ as.factor(weekend),data=nhanes))
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Response: modvigmin
                      Df   Sum Sq Mean Sq F value    Pr(>F)    
as.factor(weekend)     1   181096  181096  214.83 < 2.2e-16 ***
Residuals          42438 35773439     843                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{Soutput}
\begin{Sinput}
> anova(lm(lightmin ~ as.factor(weekend),data=nhanes))
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Response: lightmin
                      Df    Sum Sq Mean Sq F value    Pr(>F)    
as.factor(weekend)     1   1042016 1042016  133.48 < 2.2e-16 ***
Residuals          42438 331295573    7807                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{Soutput}
\begin{Sinput}
> anova(lm(vigmin ~ as.factor(weekend),data=nhanes))
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Response: vigmin
                      Df Sum Sq Mean Sq F value  Pr(>F)   
as.factor(weekend)     1    202 202.477   9.714 0.00183 **
Residuals          42438 884572  20.844                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> nrep <- (nhanes %>% group_by(id) %>% summarise(n=length(id)))$n
> #m1 <- lme(modvigmin~1,data=nhanes,random=~1|id,correlation=corAR1(form=~1|id),method="ML")
> m1 <- lme(modvigmin~as.factor(rep)+as.factor(dow),data=nhanes,random=~1|id,method="ML")
> re <- rep(unlist(ranef(m1)),nrep)
> nhanes$error <- nhanes$modvigmin  - predict(m1)
> eht <- nhanes %>% group_by(id) %>% summarise(e1=error[1],e2=error[2],e3=error[3],e4=error[4],e5=error[5],e6=error[6],e7=error[7])
> # ind <- which(!is.na(eht$e7))
> # boxtest <- rep(0,length(ind))
> # for(i in 1:length(ind)){
> #   boxtest[i] <- Box.test(unlist(eht[ind[i],-1]),lag=2,type="Ljung-Box")$p.value
> # }
> # summary(boxtest)
> 
> #lag 1 difference
> o1a = c(eht$e1[nrep > 1],eht$e2[nrep > 2],eht$e3[nrep > 3],eht$e4[nrep > 4],eht$e5[nrep > 5],eht$e6[nrep > 6])
> o1b = c(eht$e2[nrep > 1],eht$e3[nrep > 2],eht$e4[nrep > 3],eht$e5[nrep > 4],eht$e6[nrep > 5],eht$e7[nrep > 6])
> cor(o1a,o1b) 
\end{Sinput}
\begin{Soutput}
[1] -0.1000537
\end{Soutput}
\begin{Sinput}
> #lag 2 diff
> o2a = c(eht$e1[nrep > 2],eht$e2[nrep > 3],eht$e3[nrep > 4],eht$e4[nrep > 5],eht$e5[nrep > 6])
> o2b = c(eht$e3[nrep > 2],eht$e4[nrep > 3],eht$e5[nrep > 4],eht$e6[nrep > 5],eht$e7[nrep > 6])
> cor(o2a,o2b)
\end{Sinput}
\begin{Soutput}
[1] -0.1892647
\end{Soutput}
\begin{Sinput}
> #lag 3 diff  
> o3a = c(eht$e1[nrep > 3],eht$e2[nrep > 4],eht$e3[nrep > 5],eht$e4[nrep > 6])
> o3b = c(eht$e4[nrep > 3],eht$e5[nrep > 4],eht$e6[nrep > 5],eht$e7[nrep > 6])
> cor(o3a,o3b)
\end{Sinput}
\begin{Soutput}
[1] -0.2558842
\end{Soutput}
\begin{Sinput}
> #lag 4 diff
> o4a = c(eht$e1[nrep > 4],eht$e2[nrep > 5],eht$e3[nrep > 6])
> o4b = c(eht$e5[nrep > 4],eht$e6[nrep > 5],eht$e7[nrep > 6])
> cor(o4a,o4b)
\end{Sinput}
\begin{Soutput}
[1] -0.2653008
\end{Soutput}
\begin{Sinput}
> #lag 5 diff
> o5a = c(eht$e1[nrep > 5],eht$e2[nrep > 6])
> o5b = c(eht$e6[nrep > 5],eht$e7[nrep > 6])
> cor(o5a,o5b)
\end{Sinput}
\begin{Soutput}
[1] -0.1862721
\end{Soutput}
\end{Schunk}




\begin{Schunk}
\begin{Sinput}
> #multivariate regression on mean observed modvig, light
> a <- nhanes %>% group_by(id) %>% summarise(modvig=mean(modvigmin),light=mean(lightmin))
> y$modvig <- a$modvig
> y$light <- a$light
> m3 <- lm(with(y,cbind(glu,waist,tri,hdl,bps,bpd))~y$modvig)
> summary(m3)
\end{Sinput}
\begin{Soutput}
Response glu :

Call:
lm(formula = glu ~ y$modvig)

Residuals:
   Min     1Q Median     3Q    Max 
-62.50 -14.31  -6.71   2.63 440.78 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 107.87227    0.74640 144.524   <2e-16 ***
y$modvig     -0.18519    0.02181  -8.491   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 32.92 on 3574 degrees of freedom
  (4668 observations deleted due to missingness)
Multiple R-squared:  0.01977,	Adjusted R-squared:  0.0195 
F-statistic:  72.1 on 1 and 3574 DF,  p-value: < 2.2e-16


Response waist :

Call:
lm(formula = waist ~ y$modvig)

Residuals:
    Min      1Q  Median      3Q     Max 
-37.507 -10.795  -1.156   9.475  58.162 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 100.19115    0.34288  292.20   <2e-16 ***
y$modvig     -0.12379    0.01002  -12.36   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.12 on 3574 degrees of freedom
  (4668 observations deleted due to missingness)
Multiple R-squared:  0.04096,	Adjusted R-squared:  0.0407 
F-statistic: 152.7 on 1 and 3574 DF,  p-value: < 2.2e-16


Response tri :

Call:
lm(formula = tri ~ y$modvig)

Residuals:
    Min      1Q  Median      3Q     Max 
-121.18  -65.00  -30.59   27.40 2585.85 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 154.32305    2.85134  54.123  < 2e-16 ***
y$modvig     -0.40685    0.08331  -4.883 1.09e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 125.7 on 3574 degrees of freedom
  (4668 observations deleted due to missingness)
Multiple R-squared:  0.006628,	Adjusted R-squared:  0.00635 
F-statistic: 23.85 on 1 and 3574 DF,  p-value: 1.089e-06


Response hdl :

Call:
lm(formula = hdl ~ y$modvig)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.675 -11.922  -2.698   9.320 132.359 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  55.6949     0.3695 150.740   <2e-16 ***
y$modvig     -0.0233     0.0108  -2.158    0.031 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 16.29 on 3574 degrees of freedom
  (4668 observations deleted due to missingness)
Multiple R-squared:  0.001302,	Adjusted R-squared:  0.001022 
F-statistic: 4.658 on 1 and 3574 DF,  p-value: 0.03097


Response bps :

Call:
lm(formula = bps ~ y$modvig)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.510 -13.122  -2.921  10.172  93.694 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 126.33975    0.43377  291.26   <2e-16 ***
y$modvig     -0.13340    0.01267  -10.53   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.13 on 3574 degrees of freedom
  (4668 observations deleted due to missingness)
Multiple R-squared:  0.03006,	Adjusted R-squared:  0.02979 
F-statistic: 110.8 on 1 and 3574 DF,  p-value: < 2.2e-16


Response bpd :

Call:
lm(formula = bpd ~ y$modvig)

Residuals:
    Min      1Q  Median      3Q     Max 
-68.064  -7.423   0.529   8.164  47.533 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept) 67.729506   0.310267 218.294   <2e-16 ***
y$modvig     0.013836   0.009066   1.526    0.127    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.68 on 3574 degrees of freedom
  (4668 observations deleted due to missingness)
Multiple R-squared:  0.0006513,	Adjusted R-squared:  0.0003717 
F-statistic: 2.329 on 1 and 3574 DF,  p-value: 0.1271
\end{Soutput}
\end{Schunk}



\begin{Schunk}
\begin{Sinput}
> summary(lm(wearmin~as.factor(dow),data=nhanes))
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = wearmin ~ as.factor(dow), data = nhanes)

Residuals:
    Min      1Q  Median      3Q     Max 
-261.67 -108.24  -10.55   86.38  621.12 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      818.882      2.048 399.784  < 2e-16 ***
as.factor(dow)2   36.599      2.764  13.240  < 2e-16 ***
as.factor(dow)3   39.281      2.750  14.282  < 2e-16 ***
as.factor(dow)4   40.428      2.764  14.629  < 2e-16 ***
as.factor(dow)5   34.328      2.762  12.427  < 2e-16 ***
as.factor(dow)6   42.792      2.784  15.373  < 2e-16 ***
as.factor(dow)7   21.738      2.873   7.566 3.92e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 148.1 on 42433 degrees of freedom
Multiple R-squared:  0.008106,	Adjusted R-squared:  0.007965 
F-statistic: 57.79 on 6 and 42433 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> summary(lm(wearmin~as.factor(rep),data=nhanes))
\end{Sinput}
\begin{Soutput}
Call:
lm(formula = wearmin ~ as.factor(rep), data = nhanes)

Residuals:
    Min      1Q  Median      3Q     Max 
-258.59 -109.09  -11.53   87.27  615.71 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      850.727      1.822 466.907  < 2e-16 ***
as.factor(rep)2    7.868      2.581   3.048  0.00231 ** 
as.factor(rep)3    5.366      2.599   2.065  0.03893 *  
as.factor(rep)4    5.782      2.614   2.212  0.02700 *  
as.factor(rep)5    2.224      2.638   0.843  0.39906    
as.factor(rep)6   -2.202      2.684  -0.820  0.41198    
as.factor(rep)7  -26.440      2.807  -9.420  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 148.4 on 42433 degrees of freedom
Multiple R-squared:  0.004513,	Adjusted R-squared:  0.004372 
F-statistic: 32.06 on 6 and 42433 DF,  p-value: < 2.2e-16
\end{Soutput}
\begin{Sinput}
> table(nhanes$rep,nhanes$dow)
\end{Sinput}
\begin{Soutput}
       1    2    3    4    5    6    7
  1 1507 1482 1180  547  586  543  786
  2  722 1700 1458 1124  512  567  502
  3  451  797 1687 1378 1102  480  516
  4  473  503  789 1638 1368 1062  430
  5  398  529  486  776 1624 1294  945
  6  830  472  513  465  764 1545 1080
  7  847  882  398  445  429  683 1145
\end{Soutput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> dim(nhanes)
\end{Sinput}
\begin{Soutput}
[1] 42440    39
\end{Soutput}
\begin{Sinput}
> length(unique(nhanes$id))
\end{Sinput}
\begin{Soutput}
[1] 8244
\end{Soutput}
\begin{Sinput}
> table(nrep) #gives distribution of number of replicates
\end{Sinput}
\begin{Soutput}
nrep
   1    2    3    4    5    6    7 
 510  555  656  834 1249 1809 2631 
\end{Soutput}
\begin{Sinput}
> meas7 <- subset(nhanes, id %in% unique(id)[nrep==7]) #individuals with all 7 days
> length(unique(meas7$id[complete.cases(meas7[,c("smplwt","sex","age","race","rep","dow","wearmin","modvigmin","modvigminb","modvigbouts","glu","waist","tri","ldl","hdl","bps","bpd")])])) #with bpmed 405
\end{Sinput}
\begin{Soutput}
[1] 1103
\end{Soutput}
\begin{Sinput}
> #no big changes by taking one of the 7 metsynd variables out
> 
> id7complete <- unique(meas7$id[complete.cases(meas7[,c("smplwt","sex","age","race","rep","dow","wearmin","modvigmin","modvigminb","modvigbouts","glu","waist","tri","ldl","hdl","bps","bpd")])])
> meas67 <- subset(nhanes, id %in% unique(id)[nrep>=6] & rep <= 6) #individuals with 6 days
> length(unique(meas67$id[complete.cases(meas67[,c("smplwt","sex","age","race","rep","dow","wearmin","modvigmin","modvigminb","modvigbouts","glu","waist","tri","ldl","hdl","bps","bpd")])])) #with bpmed 638
\end{Sinput}
\begin{Soutput}
[1] 1878
\end{Soutput}
\begin{Sinput}
> meas57 <- subset(nhanes, id %in% unique(id)[nrep>=5] & rep <= 5) #individuals with 6 days
> length(unique(meas57$id[complete.cases(meas57[,c("smplwt","sex","age","race","rep","dow","wearmin","modvigmin","modvigminb","modvigbouts","glu","waist","tri","ldl","hdl","bps","bpd")])])) #with bpmed 803, 348 estv02
\end{Sinput}
\begin{Soutput}
[1] 2424
\end{Soutput}
\begin{Sinput}
> id57complete <- unique(meas57$id[complete.cases(meas57[,c("smplwt","sex","age","race","rep","dow","wearmin","modvigmin","modvigminb","modvigbouts","glu","waist","tri","ldl","hdl","bps","bpd")])])
> table((meas57 %>% group_by(id) %>% summarise(n=length(id)))$n)
\end{Sinput}
\begin{Soutput}
   3    4    5 
 333 1510 3846 
\end{Soutput}
\begin{Sinput}
> table((meas67 %>% group_by(id) %>% summarise(n=length(id)))$n)
\end{Sinput}
\begin{Soutput}
   5    6 
1088 3352 
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> q1 <- lm(modvigmin~as.factor(rep),data=nhanes)
> nhanes$rep2 <- nhanes$rep
> nhanes$rep2[nhanes$rep %in% c(1:5)] <- 1
> q2 <- lm(modvigmin~as.factor(rep2),data=nhanes)
> anova(q1,q2)
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Model 1: modvigmin ~ as.factor(rep)
Model 2: modvigmin ~ as.factor(rep2)
  Res.Df      RSS Df Sum of Sq      F Pr(>F)
1  42433 35902020                           
2  42437 35904922 -4   -2901.8 0.8574 0.4887
\end{Soutput}
\begin{Sinput}
> q3 <- lm(modvigmin~as.factor(dow),data=nhanes)
> q4 <- lm(modvigmin~as.factor(weekend),data=nhanes)
> nhanes$dow2 <- nhanes$dow
> nhanes$dow2[nhanes$dow %in% c(2:6)] <- 2
> q5 <- lm(modvigmin~as.factor(dow2),data=nhanes)
> anova(q3,q4)
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Model 1: modvigmin ~ as.factor(dow)
Model 2: modvigmin ~ as.factor(weekend)
  Res.Df      RSS Df Sum of Sq      F    Pr(>F)    
1  42433 35755786                                  
2  42438 35773439 -5    -17653 4.1899 0.0008297 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{Soutput}
\begin{Sinput}
> anova(q3,q5)
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Model 1: modvigmin ~ as.factor(dow)
Model 2: modvigmin ~ as.factor(dow2)
  Res.Df      RSS Df Sum of Sq      F Pr(>F)
1  42433 35755786                           
2  42437 35762149 -4     -6363 1.8878 0.1095
\end{Soutput}
\begin{Sinput}
> q1 <- lm(modvigmin~as.factor(rep),data=meas7)
> meas7$rep2 <- meas7$rep
> meas7$rep2[meas7$rep %in% c(1:5)] <- 1
> q2 <- lm(modvigmin~as.factor(rep2),data=meas7)
> anova(q1,q2)
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Model 1: modvigmin ~ as.factor(rep)
Model 2: modvigmin ~ as.factor(rep2)
  Res.Df      RSS Df Sum of Sq      F Pr(>F)
1  18410 14037352                           
2  18414 14038137 -4   -785.07 0.2574 0.9053
\end{Soutput}
\begin{Sinput}
> q3 <- lm(modvigmin~as.factor(dow),data=meas7)
> q4 <- lm(modvigmin~as.factor(weekend),data=meas7)
> meas7$dow2 <- meas7$dow
> meas7$dow2[meas7$dow %in% c(2:6)] <- 2
> q5 <- lm(modvigmin~as.factor(dow2),data=meas7)
> anova(q3,q4)
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Model 1: modvigmin ~ as.factor(dow)
Model 2: modvigmin ~ as.factor(weekend)
  Res.Df      RSS Df Sum of Sq     F Pr(>F)
1  18410 13976558                          
2  18415 13983155 -5   -6597.3 1.738 0.1221
\end{Soutput}
\begin{Sinput}
> anova(q3,q5)
\end{Sinput}
\begin{Soutput}
Analysis of Variance Table

Model 1: modvigmin ~ as.factor(dow)
Model 2: modvigmin ~ as.factor(dow2)
  Res.Df      RSS Df Sum of Sq      F Pr(>F)
1  18410 13976558                           
2  18414 13977073 -4   -515.62 0.1698 0.9539
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> m1a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corCompSymm(form=~1|id),method="ML")
> m2a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corAR1(form=~1|id),method="ML")
> m3a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corARMA(form=~1|id,p=1,q=1),method="ML")
> m4a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corARMA(form=~1|id,p=2,q=0),method="ML")
> m6a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corARMA(form=~1|id,p=2,q=1),method="ML")
> m7a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corSymm(form=~1|id),method="ML")
> m8a <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas7,correlation=corSymm(form=~1|id),weight = varIdent(form = ~ 1|rep),method="ML")
> extractAIC(m1a)
\end{Sinput}
\begin{Soutput}
[1]     15.0 164398.1
\end{Soutput}
\begin{Sinput}
> extractAIC(m2a)
\end{Sinput}
\begin{Soutput}
[1]     15.0 166262.7
\end{Soutput}
\begin{Sinput}
> extractAIC(m3a)
\end{Sinput}
\begin{Soutput}
[1]     16.0 164252.2
\end{Soutput}
\begin{Sinput}
> extractAIC(m4a)
\end{Sinput}
\begin{Soutput}
[1]     16.0 164938.2
\end{Soutput}
\begin{Sinput}
> extractAIC(m6a)
\end{Sinput}
\begin{Soutput}
[1]     17.0 164181.5
\end{Soutput}
\begin{Sinput}
> extractAIC(m7a)
\end{Sinput}
\begin{Soutput}
[1]     35.0 164043.4
\end{Soutput}
\begin{Sinput}
> extractAIC(m8a)
\end{Sinput}
\begin{Soutput}
[1]     41.0 164029.9
\end{Soutput}
\begin{Sinput}
> anova(m3a,m2a)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m3a     1 16 164252.2 164377.3 -82110.08                        
m2a     2 15 166262.8 166380.1 -83116.37 1 vs 2 2012.582  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m6a,m3a)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m6a     1 17 164181.5 164314.4 -82073.73                        
m3a     2 16 164252.2 164377.3 -82110.08 1 vs 2 72.71033  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m7a,m6a)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m7a     1 35 164043.4 164317.1 -81986.68                        
m6a     2 17 164181.5 164314.4 -82073.73 1 vs 2 174.0954  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m8a,m7a)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m8a     1 41 164029.9 164350.5 -81973.94                        
m7a     2 35 164043.4 164317.1 -81986.68 1 vs 2 25.47542   3e-04
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> meas57sub <- subset(meas57,rep <=5)
> m1b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57sub,correlation=corCompSymm(form=~1|id),method="ML")
> m2b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57sub,correlation=corAR1(form=~1|id),method="ML")
> m3b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57sub,correlation=corARMA(form=~1|id,p=1,q=1),method="ML")
> m4b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57sub,correlation=corARMA(form=~1|id,p=2,q=0),method="ML")
> m6b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57sub,correlation=corARMA(form=~1|id,p=2,q=1),method="ML")
> m7b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57sub,correlation=corSymm(form=~1|id),method="ML")
> m8b <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas57,correlation=corSymm(form=~1|id),weight = varIdent(form = ~ 1|rep),method="ML")
> extractAIC(m1b)
\end{Sinput}
\begin{Soutput}
[1]     13 238400
\end{Soutput}
\begin{Sinput}
> extractAIC(m2b)
\end{Sinput}
\begin{Soutput}
[1]     13.0 240187.2
\end{Soutput}
\begin{Sinput}
> extractAIC(m3b)
\end{Sinput}
\begin{Soutput}
[1]     14.0 238171.1
\end{Soutput}
\begin{Sinput}
> extractAIC(m4b)
\end{Sinput}
\begin{Soutput}
[1]     14.0 238567.7
\end{Soutput}
\begin{Sinput}
> extractAIC(m6b)
\end{Sinput}
\begin{Soutput}
[1]     15 238171
\end{Soutput}
\begin{Sinput}
> extractAIC(m7b)
\end{Sinput}
\begin{Soutput}
[1]     22.0 238067.3
\end{Soutput}
\begin{Sinput}
> extractAIC(m8b)
\end{Sinput}
\begin{Soutput}
[1]     26.0 238041.9
\end{Soutput}
\begin{Sinput}
> anova(m3b,m2b)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m3b     1 14 238171.1 238285.6 -119071.6                        
m2b     2 13 240187.2 240293.5 -120080.6 1 vs 2 2018.088  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m6b,m3b)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m6b     1 15 238171.0 238293.7 -119070.5                        
m3b     2 14 238171.1 238285.6 -119071.6 1 vs 2 2.070635  0.1502
\end{Soutput}
\begin{Sinput}
> anova(m7b,m3b)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m7b     1 22 238067.3 238247.2 -119011.6                        
m3b     2 14 238171.1 238285.6 -119071.6 1 vs 2 119.8111  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m8b,m7b)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m8b     1 26 238041.9 238254.4 -118994.9                        
m7b     2 22 238067.3 238247.2 -119011.6 1 vs 2 33.45403  <.0001
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> meas67sub <- subset(meas67,rep <=6)
> m1c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corCompSymm(form=~1|id),method="ML")
> m2c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corAR1(form=~1|id),method="ML")
> m3c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corARMA(form=~1|id,p=1,q=1),method="ML")
> m4c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corARMA(form=~1|id,p=2,q=0),method="ML")
> m6c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corARMA(form=~1|id,p=2,q=1),method="ML")
> m7c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corSymm(form=~1|id),method="ML")
> m8c <- gls(modvigmin~as.factor(dow)+as.factor(rep),data=meas67sub,correlation=corSymm(form=~1|id),weight = varIdent(form = ~ 1|rep),method="ML")
> extractAIC(m1c)
\end{Sinput}
\begin{Soutput}
[1]     14.0 230404.8
\end{Soutput}
\begin{Sinput}
> extractAIC(m2c)
\end{Sinput}
\begin{Soutput}
[1]     14.0 232528.5
\end{Soutput}
\begin{Sinput}
> extractAIC(m3c)
\end{Sinput}
\begin{Soutput}
[1]     15 230100
\end{Soutput}
\begin{Sinput}
> extractAIC(m4c)
\end{Sinput}
\begin{Soutput}
[1]     15.0 230692.3
\end{Soutput}
\begin{Sinput}
> extractAIC(m6c)
\end{Sinput}
\begin{Soutput}
[1]     16.0 230093.7
\end{Soutput}
\begin{Sinput}
> extractAIC(m7c)
\end{Sinput}
\begin{Soutput}
[1]     28.0 229972.9
\end{Soutput}
\begin{Sinput}
> extractAIC(m8c)
\end{Sinput}
\begin{Soutput}
[1]     33.0 229956.5
\end{Soutput}
\begin{Sinput}
> anova(m3c,m2c)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m3c     1 15 230100.0 230222.2 -115035.0                        
m2c     2 14 232528.5 232642.6 -116250.2 1 vs 2 2430.536  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m6c,m3c)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m6c     1 16 230093.7 230224.0 -115030.8                        
m3c     2 15 230100.0 230222.2 -115035.0 1 vs 2 8.293493   0.004
\end{Soutput}
\begin{Sinput}
> anova(m7c,m6c)
\end{Sinput}
\begin{Soutput}
    Model df      AIC    BIC    logLik   Test  L.Ratio p-value
m7c     1 28 229972.9 230201 -114958.4                        
m6c     2 16 230093.7 230224 -115030.8 1 vs 2 144.7848  <.0001
\end{Soutput}
\begin{Sinput}
> anova(m7c,m8c)
\end{Sinput}
\begin{Soutput}
    Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m7c     1 28 229972.9 230201.0 -114958.4                        
m8c     2 33 229956.5 230225.4 -114945.3 1 vs 2 26.35735   1e-04
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> lme1 <- lme(modvigmin~as.factor(dow)+as.factor(rep),random=~1|id,data=meas7,correlation=corSymm(form=~1|id),method="ML",control=list(msMaxIter=100))
> 
> 
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> summary(m8a) #gls without random effects
\end{Sinput}
\begin{Soutput}
Generalized least squares fit by maximum likelihood
  Model: modvigmin ~ as.factor(dow) + as.factor(rep) 
  Data: meas7 
       AIC      BIC    logLik
  164029.9 164350.5 -81973.94

Correlation Structure: General
 Formula: ~1 | id 
 Parameter estimate(s):
 Correlation: 
  1     2     3     4     5     6    
2 0.600                              
3 0.583 0.651                        
4 0.523 0.578 0.658                  
5 0.550 0.608 0.661 0.682            
6 0.561 0.536 0.603 0.600 0.634      
7 0.558 0.539 0.557 0.517 0.554 0.586
Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | rep 
 Parameter estimates:
        1         2         3         4         5         6         7 
1.0000000 0.9823352 1.0260409 1.0028533 1.0260458 0.9976716 0.9599137 

Coefficients:
                    Value Std.Error   t-value p-value
(Intercept)     17.195103 0.6072096 28.318233  0.0000
as.factor(dow)2  5.415249 0.4702770 11.515019  0.0000
as.factor(dow)3  5.052452 0.4976650 10.152314  0.0000
as.factor(dow)4  4.876995 0.5138790  9.490551  0.0000
as.factor(dow)5  4.907845 0.5136416  9.554999  0.0000
as.factor(dow)6  4.647601 0.4972114  9.347334  0.0000
as.factor(dow)7  2.268762 0.4728772  4.797782  0.0000
as.factor(rep)2 -0.539641 0.4805194 -1.123037  0.2614
as.factor(rep)3 -0.308111 0.5049796 -0.610145  0.5418
as.factor(rep)4 -0.384855 0.5367814 -0.716967  0.4734
as.factor(rep)5 -0.081066 0.5277860 -0.153596  0.8779
as.factor(rep)6 -0.831819 0.5105435 -1.629282  0.1033
as.factor(rep)7 -1.590955 0.4992559 -3.186652  0.0014

 Correlation: 
                (Intr) as.fctr(d)2 as.fctr(d)3 as.fctr(d)4 as.fctr(d)5
as.factor(dow)2 -0.363                                                
as.factor(dow)3 -0.376  0.537                                         
as.factor(dow)4 -0.355  0.500       0.585                             
as.factor(dow)5 -0.358  0.471       0.533       0.601                 
as.factor(dow)6 -0.337  0.435       0.475       0.529       0.581     
as.factor(dow)7 -0.342  0.442       0.439       0.467       0.505     
as.factor(rep)2 -0.365 -0.095      -0.075      -0.105      -0.054     
as.factor(rep)3 -0.314 -0.074      -0.141      -0.153      -0.135     
as.factor(rep)4 -0.368 -0.030      -0.080      -0.168      -0.138     
as.factor(rep)5 -0.336 -0.036      -0.049      -0.126      -0.171     
as.factor(rep)6 -0.385  0.019      -0.003      -0.047      -0.078     
as.factor(rep)7 -0.423 -0.016       0.017      -0.034      -0.029     
                as.fctr(d)6 as.fctr(d)7 as.fctr(r)2 as.fctr(r)3 as.fctr(r)4
as.factor(dow)2                                                            
as.factor(dow)3                                                            
as.factor(dow)4                                                            
as.factor(dow)5                                                            
as.factor(dow)6                                                            
as.factor(dow)7  0.538                                                     
as.factor(rep)2 -0.060      -0.020                                         
as.factor(rep)3 -0.093      -0.062       0.574                             
as.factor(rep)4 -0.131      -0.054       0.525       0.619                 
as.factor(rep)5 -0.151      -0.108       0.531       0.599       0.660     
as.factor(rep)6 -0.137      -0.075       0.443       0.522       0.565     
as.factor(rep)7 -0.070      -0.093       0.461       0.474       0.479     
                as.fctr(r)5 as.fctr(r)6
as.factor(dow)2                        
as.factor(dow)3                        
as.factor(dow)4                        
as.factor(dow)5                        
as.factor(dow)6                        
as.factor(dow)7                        
as.factor(rep)2                        
as.factor(rep)3                        
as.factor(rep)4                        
as.factor(rep)5                        
as.factor(rep)6  0.591                 
as.factor(rep)7  0.503       0.542     

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-0.8204756 -0.6334503 -0.3732255  0.2776025 11.0484393 

Residual standard error: 27.55761 
Degrees of freedom: 18417 total; 18404 residual
\end{Soutput}
\begin{Sinput}
> summary(lme1) #lme with person random effects
\end{Sinput}
\begin{Soutput}
Linear mixed-effects model fit by maximum likelihood
 Data: meas7 
       AIC      BIC    logLik
  164045.4 164326.9 -81986.68

Random effects:
 Formula: ~1 | id
        (Intercept) Residual
StdDev:    20.96887 17.70431

Correlation Structure: General
 Formula: ~1 | id 
 Parameter estimate(s):
 Correlation: 
  1      2      3      4      5      6     
2  0.039                                   
3 -0.014  0.150                            
4 -0.157 -0.025  0.156                     
5 -0.094  0.045  0.159  0.215              
6 -0.058 -0.119  0.030  0.026  0.103       
7 -0.050 -0.093 -0.067 -0.159 -0.073  0.015
Fixed effects: modvigmin ~ as.factor(dow) + as.factor(rep) 
                    Value Std.Error    DF   t-value p-value
(Intercept)     17.155424 0.6056263 15774 28.326747  0.0000
as.factor(dow)2  5.389369 0.4717563 15774 11.424053  0.0000
as.factor(dow)3  5.111234 0.4982571 15774 10.258225  0.0000
as.factor(dow)4  4.962784 0.5149659 15774  9.637112  0.0000
as.factor(dow)5  5.016498 0.5138607 15774  9.762371  0.0000
as.factor(dow)6  4.782022 0.4984427 15774  9.593926  0.0000
as.factor(dow)7  2.308563 0.4743139 15774  4.867163  0.0000
as.factor(rep)2 -0.543721 0.4825259 15774 -1.126822  0.2598
as.factor(rep)3 -0.327594 0.4995908 15774 -0.655725  0.5120
as.factor(rep)4 -0.417864 0.5362563 15774 -0.779224  0.4359
as.factor(rep)5 -0.113583 0.5221804 15774 -0.217516  0.8278
as.factor(rep)6 -0.859242 0.5099838 15774 -1.684842  0.0920
as.factor(rep)7 -1.598256 0.5041180 15774 -3.170399  0.0015
 Correlation: 
                (Intr) as.fctr(d)2 as.fctr(d)3 as.fctr(d)4 as.fctr(d)5
as.factor(dow)2 -0.365                                                
as.factor(dow)3 -0.379  0.538                                         
as.factor(dow)4 -0.357  0.501       0.586                             
as.factor(dow)5 -0.361  0.472       0.536       0.603                 
as.factor(dow)6 -0.339  0.435       0.477       0.531       0.583     
as.factor(dow)7 -0.344  0.442       0.440       0.469       0.507     
as.factor(rep)2 -0.350 -0.095      -0.075      -0.105      -0.055     
as.factor(rep)3 -0.334 -0.076      -0.142      -0.155      -0.137     
as.factor(rep)4 -0.371 -0.030      -0.081      -0.169      -0.139     
as.factor(rep)5 -0.355 -0.037      -0.050      -0.127      -0.173     
as.factor(rep)6 -0.383  0.019      -0.003      -0.047      -0.078     
as.factor(rep)7 -0.390 -0.016       0.016      -0.034      -0.029     
                as.fctr(d)6 as.fctr(d)7 as.fctr(r)2 as.fctr(r)3 as.fctr(r)4
as.factor(dow)2                                                            
as.factor(dow)3                                                            
as.factor(dow)4                                                            
as.factor(dow)5                                                            
as.factor(dow)6                                                            
as.factor(dow)7  0.539                                                     
as.factor(rep)2 -0.060      -0.020                                         
as.factor(rep)3 -0.095      -0.063       0.572                             
as.factor(rep)4 -0.132      -0.054       0.518       0.620                 
as.factor(rep)5 -0.153      -0.109       0.528       0.602       0.659     
as.factor(rep)6 -0.138      -0.075       0.435       0.523       0.563     
as.factor(rep)7 -0.069      -0.092       0.449       0.472       0.469     
                as.fctr(r)5 as.fctr(r)6
as.factor(dow)2                        
as.factor(dow)3                        
as.factor(dow)4                        
as.factor(dow)5                        
as.factor(dow)6                        
as.factor(dow)7                        
as.factor(rep)2                        
as.factor(rep)3                        
as.factor(rep)4                        
as.factor(rep)5                        
as.factor(rep)6  0.592                 
as.factor(rep)7  0.500       0.536     

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-8.5214813 -0.3494593 -0.1229919  0.2127351  9.5852780 

Number of Observations: 18417
Number of Groups: 2631 
\end{Soutput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> meas7$error <- meas7$modvigmin  - predict(lme1)
> eht <- meas7 %>% group_by(id) %>% summarise(e1=error[1],e2=error[2],e3=error[3],e4=error[4],e5=error[5],e6=error[6],e7=error[7])
> # ind <- which(!is.na(eht$e7))
> # boxtest <- rep(0,length(ind))
> # for(i in 1:length(ind)){
> #   boxtest[i] <- Box.test(unlist(eht[ind[i],-1]),lag=2,type="Ljung-Box")$p.value
> # }
> # summary(boxtest)
> 
> #lag 1 difference
> o1a = c(eht$e1,eht$e2,eht$e3,eht$e4,eht$e5,eht$e6)
> o1b = c(eht$e2,eht$e3,eht$e4,eht$e5,eht$e6,eht$e7)
> cor(o1a,o1b) 
\end{Sinput}
\begin{Soutput}
[1] -0.007183107
\end{Soutput}
\begin{Sinput}
> #lag 2 diff
> o2a = c(eht$e1,eht$e2,eht$e3,eht$e4,eht$e5)
> o2b = c(eht$e3,eht$e4,eht$e5,eht$e6,eht$e7)
> cor(o2a,o2b)
\end{Sinput}
\begin{Soutput}
[1] -0.1185028
\end{Soutput}
\begin{Sinput}
> #lag 3 diff  
> o3a = c(eht$e1,eht$e2,eht$e3,eht$e4)
> o3b = c(eht$e4,eht$e5,eht$e6,eht$e7)
> cor(o3a,o3b)
\end{Sinput}
\begin{Soutput}
[1] -0.2046897
\end{Soutput}
\begin{Sinput}
> #lag 4 diff
> o4a = c(eht$e1,eht$e2,eht$e3)
> o4b = c(eht$e5,eht$e6,eht$e7)
> cor(o4a,o4b)
\end{Sinput}
\begin{Soutput}
[1] -0.2444852
\end{Soutput}
\begin{Sinput}
> #lag 5 diff
> o5a = c(eht$e1,eht$e2)
> o5b = c(eht$e6,eht$e7)
> cor(o5a,o5b)
\end{Sinput}
\begin{Soutput}
[1] -0.2259102
\end{Soutput}
\end{Schunk}



\begin{Schunk}
\begin{Sinput}
> summary(nhanes$wearmin)
\end{Sinput}
\begin{Soutput}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  600.0   741.0   839.0   850.6   938.0  1440.0 
\end{Soutput}
\begin{Sinput}
> summary(meas7$wearmin)
\end{Sinput}
\begin{Soutput}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  600.0   787.0   876.0   885.8   965.0  1440.0 
\end{Soutput}
\begin{Sinput}
> minweartime <- (meas7 %>% group_by(id) %>% summarise(minimum=min(wearmin),avg=mean(wearmin)))
> sum(minweartime$minimum[minweartime$id %in% id7complete] > 1000)
\end{Sinput}
\begin{Soutput}
[1] 21
\end{Soutput}
\begin{Sinput}
> sum(minweartime$minimum[minweartime$id %in% id7complete] > 800)
\end{Sinput}
\begin{Soutput}
[1] 254
\end{Soutput}
\begin{Sinput}
> sum(minweartime$minimum[minweartime$id %in% id7complete] > 700)
\end{Sinput}
\begin{Soutput}
[1] 663
\end{Soutput}
\begin{Sinput}
> summary(minweartime$avg[minweartime$id %in% id7complete])
\end{Sinput}
\begin{Soutput}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  654.6   821.9   873.6   885.6   928.8  1385.0 
\end{Soutput}
\begin{Sinput}
> minweartime5 <- (meas57 %>% group_by(id) %>% summarise(minimum=min(wearmin),avg=mean(wearmin)))
> sum(minweartime5$minimum[minweartime5$id %in% id57complete] > 1000)
\end{Sinput}
\begin{Soutput}
[1] 66
\end{Soutput}
\begin{Sinput}
> sum(minweartime5$minimum[minweartime5$id %in% id57complete] > 800)
\end{Sinput}
\begin{Soutput}
[1] 691
\end{Soutput}
\begin{Sinput}
> sum(minweartime5$minimum[minweartime5$id %in% id57complete] > 700)
\end{Sinput}
\begin{Soutput}
[1] 1528
\end{Soutput}
\begin{Sinput}
> summary(minweartime5$avg[minweartime5$id %in% id57complete])
\end{Sinput}
\begin{Soutput}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  624.0   790.3   854.0   865.0   920.6  1398.0 
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}


\begin{Schunk}
\begin{Sinput}
> wpall <- nhanes %>% group_by(id)  %>% summarise(m=mean(modvigmin),s=sd(modvigmin),ml=mean(log(modvigmin)),sl=sd(log(modvigmin)))
> qplot(x=wpall$m,y=wpall$s) + geom_smooth(method="lm")
> qplot(x=wpall$ml,y=wpall$sl)+ geom_smooth(method="lm")
> 
\end{Sinput}
\end{Schunk}

\begin{Schunk}
\begin{Sinput}
> nhanes$bmigroup <- 1
> nhanes$bmigroup[nhanes$bmi >= 18] <- 2
> nhanes$bmigroup[nhanes$bmi >= 25] <- 3
> nhanes$bmigroup[nhanes$bmi >= 30] <- 4
> nhanes$bmigroup[nhanes$bmi >= 35] <- 5
> nhanes$agegroup <- 1
> nhanes$agegroup[nhanes$age >= 25] <- 2
> nhanes$agegroup[nhanes$age >= 35] <- 3
> nhanes$agegroup[nhanes$age >= 45] <- 4
> nhanes$agegroup[nhanes$age >= 55] <- 5
> nhanes$agegroup[nhanes$age >= 65] <- 6
> nhanes %>% group_by(sex) %>% summarise(mean(wearmin),sd(wearmin)/sqrt(length(wearmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 2 x 3
    sex `mean(wearmin)` `sd(wearmin)/sqrt(length(wearmin))`
  <int>           <dbl>                               <dbl>
1     1        862.4040                           1.0745519
2     2        839.2255                           0.9610608
\end{Soutput}
\begin{Sinput}
> nhanes %>% group_by(race) %>% summarise(mean(wearmin),sd(wearmin)/sqrt(length(wearmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 5 x 3
   race `mean(wearmin)` `sd(wearmin)/sqrt(length(wearmin))`
  <int>           <dbl>                               <dbl>
1     1        838.3973                            1.504752
2     2        837.8630                            4.226087
3     3        848.6774                            0.944356
4     4        868.9508                            1.864345
5     5        855.5710                            3.544238
\end{Soutput}
\begin{Sinput}
> nhanes %>% group_by(bmigroup) %>% summarise(mean(wearmin),sd(wearmin)/sqrt(length(wearmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 5 x 3
  bmigroup `mean(wearmin)` `sd(wearmin)/sqrt(length(wearmin))`
     <dbl>           <dbl>                               <dbl>
1        1        853.8333                            7.185609
2        2        851.4379                            1.257627
3        3        855.4751                            1.212399
4        4        847.2281                            1.658649
5        5        839.8965                            2.096613
\end{Soutput}
\begin{Sinput}
> nhanes %>% group_by(agegroup) %>% summarise(mean(wearmin),sd(wearmin)/sqrt(length(wearmin)))
\end{Sinput}
\begin{Soutput}
# A tibble: 6 x 3
  agegroup `mean(wearmin)` `sd(wearmin)/sqrt(length(wearmin))`
     <dbl>           <dbl>                               <dbl>
1        1        841.3575                            2.053093
2        2        845.0387                            1.823399
3        3        856.7826                            1.809899
4        4        876.1550                            1.893967
5        5        853.2721                            1.875862
6        6        839.1086                            1.365020
\end{Soutput}
\begin{Sinput}
> #nhanes %>% group_by(sex,race,bmigroup) %>% summarise(mean(wearmin),sd(wearmin)/sqrt(length(wearmin)))
> 
> 
> qplot(x=wearmin,y=modvigmin,data=nhanes)
> qplot(x=wearmin,y=lightmin,data=nhanes)
\end{Sinput}
\end{Schunk}


\end{document}
